---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2019/10/14 19:44
---

Archive = Archive or {}


function Archive:SyncArchives(data)
    if Network:IsNotHandleNotify() then return end
    
    AppMgr:LogInfo("------------------------------------同步图鉴数据----------------------------");
    self._heroData = data.ic_heros or {};

end

function Archive:GetHaveMusicBook()
    local tempArr = {};
    if(self.haveEquip ~= nil)then
        for i, v in pairs(self.haveMusicBook) do
            table.insert(tempArr,tonumber(v));
        end
    end
    return tempArr;
end
function Archive:UpdateHaveMusicBook(bookid)
    if(self.haveMusicBook[tonumber(bookid)] == nil)then
        self.haveMusicBook[tonumber(bookid)] = tonumber(bookid);
    end
end

--获取角色加成
function Archive:GetHeroAddReq()
    Network:CallServerScript({c2s.PICTORIAL_ICHERO_GET_ATTR_REQ,self._selectHeroId});
end

--获取角色加成返回
function Archive:GetHeroAddRep(heroId,star)
    --删除旧属性
    self:RemoveHeroAttrAdd(heroId);
    self:RemoveHeroBuildAdd(heroId);
    --设置星级
    self._heroData[heroId] = star;
    --添加新属性
    self:AddHeroAttrAdd(heroId);
    self:AddHeroBuildAdd(heroId);
    Hero:CalAllHeroAttr()
    Groble_UIMgr:ShowArchiveAttrTipsLayer(function ()
        SingletonMgr:ShowFightingUpTipsLayer(Hero.ShowFightingUpType.All,0);
        GEvent:fireEvent(EVENT_TYPE.UPDATE_ARCHIVE_ADD);
    end);

end

--------------------------------------------------回调----------------------------------------
c2s[c2s.PICTORIAL_DATA_SYNC]                = {Archive, Archive.SyncArchives};
c2s[c2s.PICTORIAL_ICHERO_GET_ATTR_RES]      = {Archive, Archive.GetHeroAddRep};