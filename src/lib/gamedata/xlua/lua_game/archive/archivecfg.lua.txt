---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2019/10/14 19:43
---
Archive = Archive or {};

function Archive:_LoadCfg()
    self:LoadHandBookCfg();
end

function Archive:LoadHandBookCfg()
    self._handBookCfg = {};
    local cfgs = CfgLoader:LoadCfg("HandBook");
    local cfg;
    for i, v in pairs(cfgs) do
        cfg = {
            id = tonumber(v.id),
            attrAdd = lua_parse_cfg(v.attr_add,true),
            buildAdd = lua_parse_cfg(v.build_add,true),
            sortIndex = tonumber(v.order),
        }
        self._handBookCfg[tonumber(v.id)] = cfg;
    end
    self:SetIdByAtkType();
end

function Archive:SetIdByAtkType()
    self._photoIds = {};
    local hero;
    for _, v in pairs(Hero.AtkTypes) do
        self._photoIds[v] = {};
        for i, v2 in pairs(self._handBookCfg) do
            hero = Hero:GetHero(v2.id);
            if(tonumber(hero.config.AtkType) == v)then
                table.insert(self._photoIds[v],v2);
            end
        end
        table.sort(self._photoIds[v],function (a,b)
            return a.sortIndex < b.sortIndex;
        end);
    end
end

function Archive:GetHandBookCfgByHeroId(heroId)
    if(heroId == nil or heroId == 0)then
        CS.Logger.LogError("heroId is nil or 0");
    end
    return self._handBookCfg[heroId];
end