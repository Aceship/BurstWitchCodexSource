---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2019/9/20 16:35
---
local GrowUpItem = class("GrowUpItem");

--初始化
function GrowUpItem:ctor(super, trans)
    self.transform = trans;
    self.data = {};
    self.cfg = nil;
    self.leftBg = trans:Find("left_bg"):GetComponent("Image")--.onClick:AddListener(coroutine_cal(
    self.rightBg = trans:Find("right_bg"):GetComponent("Image")
    self.titleImg = trans:Find("title_img"):GetComponent("Image");
    self.titleTxt = trans:Find("title_txt"):GetComponent("Text");
    self.getTxt = trans:Find("get_txt"):GetComponent("Text");
    self.numTxt = trans:Find("title_txt/num_txt"):GetComponent("Text");
    self.unitTxt = trans:Find("title_txt/unit_txt"):GetComponent("Text");
    self.goodsBg = trans:Find("goods_bg");
    self.btnClick = trans:Find("btn_click"):GetComponent("Button");
    self.getIsOver = trans:Find("get_is_over");
    self.rightItem = Bag:CtorComSimpleGoodsUi(trans:Find("right_item"));
    self.rightbBn = self.rightItem:Find("button_click"):GetComponent("Button");


    self.imgTitleBg = trans:Find("title_bg"):GetComponent("Image");
    self.slider = trans:Find("slider"):GetComponent("Slider");
    self.sliderImg = self.slider.transform:Find("Fill Area/Fill"):GetComponent("Image");
    self.textPer = trans:Find("text_per"):GetComponent("Text");
end


function GrowUpItem:SetData(cfg,cllBack)
    self.cfg = cfg;
    self.data =Operation:GetData();
    local playerLv = Player:GetLevel();
    self.numTxt.text = cfg.lv;
    self.slider.maxValue = cfg.lv;
    self.slider.value = playerLv;
    self.textPer.text = playerLv..string.format(LanguageMgr:GetTextByID(99000011),cfg.lv)--"<color=#8d8d8dff><size=26>/"..cfg.lv .."</size></color>";
    Bag:SetComSimpleGoodsUi(self.rightItem,cfg.award[1][1],cfg.award[1][2],cfg.award[1][3])
   -- Item:SetItemUi(self.rightItem,cfg.award[1][2],cfg.award[1][3]);
    if(self.data.charged[cfg.group] ~= nil)then
        if(playerLv >= cfg.lv) then
            set_obj_active(self.getTxt.transform,true);
            if(self.data.growupids[cfg.id] ~= nil)then
                self:SetGetIsOver();
            else
                set_obj_active(self.btnClick.transform,true);
                set_obj_active(self.getIsOver,false);
                self.titleImg.color = COLOR_TYPE.Black;
                self.titleTxt.color = COLOR_TYPE.Black;
                self.numTxt.color = COLOR_TYPE.Black;
                self.textPer.color = COLOR_TYPE.Black;
                self.unitTxt.color = COLOR_TYPE.Black;
                self.getTxt.color = COLOR_TYPE.White;
                self.imgTitleBg.color = COLOR_TYPE.Gray55;
                self.rightBg.sprite = AtlasMgr:LoadAtlasSprite("source_atlas/atlas_newer_layer_2", "img_bg_muguangxunli_renwudi2_b")
                self.getTxt:SetTextById(90026);
                self.leftBg.sprite = AtlasMgr:LoadAtlasSprite("source_atlas/atlas_newer_layer_2", "img_bg_mnvshouce_renwudi1_b")
                self.sliderImg.sprite = AtlasMgr:LoadAtlasSprite(AtlasMgr.COM_RES, "Img_s_RenWu_JinDuTiao")
            end
        else
            self:SetMissLv();
        end
    else
        self:SetMissLv();
    end
    if(cllBack ~= nil)then
        cllBack(self.transform);
    end
end



function GrowUpItem:AddListener(back)
    self.btnClick.onClick:AddListener(function ()
        back(self.cfg.id);
    end);
    self.rightbBn.onClick:AddListener(function ()
    SingletonMgr:ShowItemTipsLayer(self.rightItem.obj, Bag.TYPE_ITEM, self.cfg.award[1][2], false);
end);
end

function GrowUpItem:SetMissLv()
    set_obj_active(self.getTxt.transform,false);
    set_obj_active(self.getIsOver,false);
    set_obj_active(self.btnClick.transform,false);
    self.titleImg.color = COLOR_TYPE.White;
    self.titleTxt.color = COLOR_TYPE.White;
    self.numTxt.color = COLOR_TYPE.White;
    self.textPer.color = COLOR_TYPE.White;
    self.unitTxt.color = COLOR_TYPE.White;
    self.imgTitleBg.color = COLOR_TYPE.Black;
    self.rightBg.sprite = AtlasMgr:LoadAtlasSprite("source_atlas/atlas_newer_layer_2", "img_bg_muguangxunli_renwudi2_a")
    self.leftBg.sprite = AtlasMgr:LoadAtlasSprite("source_atlas/atlas_newer_layer_2", "img_bg_muguangxunli_renwudi1_a")
    self.sliderImg.sprite = AtlasMgr:LoadAtlasSprite(AtlasMgr.COM_RES, "Img_n_RenWu_JinDuTiao")
end

function GrowUpItem:SetGetIsOver()
    set_obj_active(self.btnClick.transform,false);
    set_obj_active(self.getIsOver,true);
    set_obj_active(self.getTxt.transform,true);
    self.titleImg.color = COLOR_TYPE.White;
    self.titleTxt.color = COLOR_TYPE.White;
    self.numTxt.color = COLOR_TYPE.White;
    self.textPer.color = COLOR_TYPE.White;
    self.unitTxt.color = COLOR_TYPE.White;
    self.imgTitleBg.color = COLOR_TYPE.Black;
    self.getTxt.color = COLOR_TYPE.Gray55;
    self.getTxt:SetTextById(90059);
    self.leftBg.sprite = AtlasMgr:LoadAtlasSprite("source_atlas/atlas_newer_layer_2", "img_bg_muguangxunli_renwudi1_a")
    self.rightBg.sprite = AtlasMgr:LoadAtlasSprite("source_atlas/atlas_newer_layer_2", "img_bg_muguangxunli_renwudi2_a")
    self.sliderImg.sprite = AtlasMgr:LoadAtlasSprite(AtlasMgr.COM_RES, "Img_s_RenWu_JinDuTiao")
end

function GrowUpItem:HideItem()
    set_obj_active(self.transform,false);
end

function GrowUpItem:OnDestroy()
    self.transform = nil;
    self.data = nil;
    self.cfg = nil;
    self.leftBg = nil
    self.rightBg = nil
    self.titleImg = nil
    self.titleTxt = nil
    self.getTxt = nil
    self.numTxt = nil
    self.unitTxt = nil
    self.goodsBg = nil
    self.btnClick = nil
    self.getIsOver = nil
    self.rightItem = nil
    self.imgTitleBg = nil
    self.slider = nil
    self.sliderImg = nil
    self.textPer = nil
end
return GrowUpItem;